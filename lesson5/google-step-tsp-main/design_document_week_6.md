# Design Document

## 第6週目　宿題
- TSP(巡回セールスマン問題)のヒューリスティックの改善

### 方針と考察
- 繰り返しによる最適解の更新
    - 同じ操作を何度も繰り返し、その中で最も総距離が短くなるものを答えとした
    - 具体的には以下の通り
        - 貪欲法->焼きなまし法->2opt法の組み合わせを10回繰り返した
        - 焼きなまし法において異なる乱数を用いながら繰り返し異なる経路を得て、総距離が最も短いものを出力した
    - 結果（改善した）
        - input_0: 3291.62
        - input_1: 3778.72
        - input_2: 4494.42 
        - input_3: 8489.92
        - input_4: 11175.46
        - input_5: 21487.59
        - input_6: 42574.32

    - ただし計算量が大きく、実行時間が長いと、繰り返しの数を減らさざるを得ない
    - 2 optを改善し、実行時間を短くした (solver_two_opt.py 38行目)
        - 具体的には、前のループで経路を変更しなかった範囲についてはそれ以降探索しないようにすることで実行時間を減らした

- 焼きなまし法の改善 (solver_sa.py 74行目)
    - 次に焼きなまし法における改悪解を許容する確率を以下のサイトを参考に変化させた
        - 参考文献 wikipedia「焼きなまし法」https://ja.wikipedia.org/wiki/%E7%84%BC%E3%81%8D%E3%81%AA%E3%81%BE%E3%81%97%E6%B3%95 (参照2023/06/19)
    - 結果（以下input_6とinput_7の結果のみ参照する）
        - input_6: 42131.64
        - input_7: 84002.42
    - 多少改善したが、この改善がたまたまなのか、必然的なものなのかが焼きなまし法への理解が薄い現段階では分からなかった

- 焼きなまし法のパラメータの調整
    - 焼きなまし法のパラメータを操作することで、より短い経路を探し当てることができるのではないかと考えた
    - 例えば、総距離が長くなる方向への変化回数が多いほど、焼きなまし法が終わった時点でより初期解から離れた様々な経路を探索できるようになり、最終的により良い解を見つけることができるのではないかと仮説を立てた
    - 以下、input_6においてパラメータを変化させた時の最終的な総距離の結果を示す
    - 焼きなまし法におけるループ100回、その内10回程度で総距離が長くなる方向への変化が起こるようなパラメータを用いた時
        - 平均総距離: 42791.59
        - 最短総距離: 42277.29
    - 焼きなまし法におけるループ100回、その内20回程度で総距離が長くなる方向への変化が起こるようなパラメータを用いた時
        - 平均総距離: 42816.97
        - 最短総距離: 42131.64
    - 焼きなまし法におけるループ1000回、その内100回程度で総距離が長くなる方向への変化が起こるようなパラメータを用いた時
        - 平均総距離: 43691.36
        - 最短総距離: 42726.01

    - 総距離が長くなる方向への変化が増えるほど、平均総距離が長くなっている。ただし、平均総距離が短いからといって何度も繰り返し操作をした中での最短総距離が短くなる訳ではない
    - たまたま総距離が短くなる（局所）最適解を引き当てることができるかが重要になってしまっている
    - 焼きなまし法をすることで、着実に大局的な最適解が見つけやすくなるような工夫が必要だと思うが、達成できなかった

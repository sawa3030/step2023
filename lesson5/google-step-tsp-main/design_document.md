# Design Document
## 第5週目　宿題
- TSP(巡回セールスマン問題)のヒューリスティックを考え、実装、分析する

### 方針と考察
#### ①2opt法(solver_two_opt.py)
- 貪欲法による経路は最も距離が短い点に移動していくなかで、ある点が取り残されてしまうことが問題点としてあげられる
- ビジュアライズされた経路を見ると、貪欲法による経路は経路の一部入れ替えるだけでより良い経路を得られそうだと考えた
- そこで2opt法を実装し、試した
    - まず、貪欲法により得られた経路を初期解とする
    - 2つのエッジの組み合わせについて、それらのエッジが指し示す先を入れ替えて経路が短くなる場合、その経路を採用しアップデートした
    - どの2つのエッジの組み合わせについて上の入れ替え操作をしても、経路が変わらなくなったときの経路を解とした
- 結果：貪欲法から改善が見られた（特に点群の数Nが多い時）（カッコの中は貪欲法による経路の総距離）
    - input_0: 3418.1 (3418.10)
    - input_1: 3832.29 (3832.29)
    - input_2: 4994.89 (5449.44)
    - input_3: 8970.05 (10519.16)
    - input_4: 11489.79 (12684.06)
    - input_5: 21363.6 (25331.84)
    - input_6: 42712.37 (49892.05)
- ビジュアライズされた経路を見ると、ある点が取り残されてしまうという問題は解決していた
- しかし、2opt法は局所最適解に陥りやすいという欠点がある

#### ①焼きなまし法(solver_two_sa.py)
- 次に局所最適解に陥りにくいと言われている焼きなまし法を試した
    - 参考文献「巡回セールスマン問題をいろんな近似解法で解く（その5: 焼きなまし法）」https://qiita.com/take314/items/7eae18045e989d7eaf52 (参照2023/06/12)
- 方針
    - solver_randomでランダムに得られた解を初期解とし、その解を焼きなまし法によって改善していった
    - 温度tがある程度小さくなると、総距離が長くなる方向への推移がほとんど起こらなくなる
    - よってtがある程度小さくなった段階で、ランダムにエッジの組み合わせを選ぶ焼きなまし法から網羅的にエッジの組み合わせを選ぶ2opt法に以降するようにした
- 結果（oが2opt法のみの時の結果と比べてより短い経路になったもの、xがより長い経路になったもの）
    - input_0: 3418.1 
    - input_1: 3778.72 o
    - input_2: 4670.27 o
    - input_3: 8813.86 o
    - input_4: 11500.35 x
    - input_5: 22277.02 x
    - input_6: 44615.61 x
- 2opt法のみを採用した時と比べて、一部のinputでは総距離が短く改善されているが、総距離が長くなっているものもある
    - 結局焼きなまし法を使っても大域最適解ではなく、局所最適解になってしまっているのではないか
    - パラメータ（初期温度t、冷却率c）について、根拠を持った値を選ぶ必要があるのかもしれない
